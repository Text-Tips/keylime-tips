# Keylime logging configuration - VERBOSE MODE
# This configuration provides maximum verbosity for debugging and troubleshooting

# The configuration file version number
[logging]
version = 2.5

[loggers]
keys = root,keylime,keylime_verifier,keylime_agent,keylime_registrar,keylime_tenant

[handlers]
keys = consoleHandler,fileHandler,debugFileHandler

[formatters]
keys = verboseFormatter,detailedFormatter

# ============================================================================
# FORMATTERS - Maximum detail output
# ============================================================================

[formatter_verboseFormatter]
# Very detailed format including thread/process info, function names, and line numbers
format = %(asctime)s.%(msecs)03d [%(process)d:%(thread)d] %(name)s:%(filename)s:%(funcName)s:%(lineno)d - %(levelname)s - %(message)s
datefmt = %Y-%m-%d %H:%M:%S

[formatter_detailedFormatter]
# Slightly less verbose but still detailed
format = %(asctime)s.%(msecs)03d - %(name)s - %(filename)s:%(lineno)d - %(levelname)s - %(message)s
datefmt = %Y-%m-%d %H:%M:%S

# ============================================================================
# HANDLERS - Console and file output
# ============================================================================

[handler_consoleHandler]
class = StreamHandler
level = DEBUG
formatter = verboseFormatter
args = (sys.stdout,)

[handler_fileHandler]
class = handlers.RotatingFileHandler
level = DEBUG
formatter = verboseFormatter
# Logs to /var/log/keylime/keylime.log with rotation at 10MB, keeping 10 backup files
args = ('/var/log/keylime/keylime.log', 'a', 10485760, 10)

[handler_debugFileHandler]
class = handlers.RotatingFileHandler
level = DEBUG
formatter = detailedFormatter
# Separate debug log file for even more detailed debugging
args = ('/var/log/keylime/keylime-debug.log', 'a', 10485760, 10)

# ============================================================================
# LOGGERS - Set all to DEBUG level for maximum verbosity
# ============================================================================

[logger_root]
# Root logger set to DEBUG - catches all logging not handled by other loggers
level = DEBUG
handlers = consoleHandler,fileHandler

[logger_keylime]
# Main keylime logger - DEBUG level for all keylime components
level = DEBUG
qualname = keylime
handlers = debugFileHandler
propagate = 1

[logger_keylime_verifier]
# Verifier-specific logging
level = DEBUG
qualname = keylime.cloudverifier
handlers =
propagate = 1

[logger_keylime_agent]
# Agent-specific logging
level = DEBUG
qualname = keylime.cloudagent
handlers =
propagate = 1

[logger_keylime_registrar]
# Registrar-specific logging
level = DEBUG
qualname = keylime.registrar
handlers =
propagate = 1

[logger_keylime_tenant]
# Tenant-specific logging
level = DEBUG
qualname = keylime.tenant
handlers =
propagate = 1
